Amendment to the original message.

Actually, as I see, the angle is calculated before any rotation is
applied. Not even sure how it works, but since the unit tests pass,
there should be no problem.
